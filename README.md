# ‚òÅÔ∏è Weather-Bot: –ì–ª—É–±–æ–∫–æ–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

---

## üí° –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –∏ —Ü–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

Weather-Bot ‚Äî —ç—Ç–æ –±–æ–ª—å—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ Telegram-–±–æ—Ç –¥–ª—è –ø–æ–≥–æ–¥—ã. –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è **–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —á—ë—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Ä–æ–ª—å, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤—ã—Å–æ–∫—É—é **–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ **–≥–∏–±–∫–æ—Å—Ç—å** –≤ –≤—ã–±–æ—Ä–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å –º–æ—â–Ω—ã–π, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Å–µ—Ä–≤–∏—Å, —Å–ø–æ—Å–æ–±–Ω—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

* **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:** –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ.
* **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ú–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø—ã—Ç—ã–≤–∞—é—Ç –Ω–∞–≥—Ä—É–∑–∫—É.
* **–ò–∑–æ–ª—è—Ü–∏—è —Å–±–æ–µ–≤:** –ü—Ä–æ–±–ª–µ–º–∞ –≤ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ –Ω–µ "—É—Ä–æ–Ω–∏—Ç" –≤—Å—é —Å–∏—Å—Ç–µ–º—É.
* **–ì–∏–±–∫–æ—Å—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª—É—á—à–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ (Python –¥–ª—è NLP –∏ Telegram, C++ –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏).

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤ –¥–µ–π—Å—Ç–≤–∏–∏ –∏ –∏—Ö —Ä–æ–ª–∏

–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤ —Ç–≤–æ—ë–º –ø—Ä–æ–µ–∫—Ç–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é —Ç–æ–±–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≥—Ä–∞—Ñ.

### 1. Telegram-–±–æ—Ç –Ω–∞ Python (`python_interface/python_bot`)

–≠—Ç–æ **—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ë–æ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å Telegram API, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏—Ö –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

* **`python-telegram-bot`**: –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.
* **`nlp_handler.py`**: –ö–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –û–Ω –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ NLP-—Å–µ—Ä–≤–∏—Å, –∞ –∑–∞—Ç–µ–º, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –ª–∏–±–æ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –∫–æ–º–∞–Ω–¥—ã –≤ Kafka, –ª–∏–±–æ –Ω–∞–ø—Ä—è–º—É—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å **—á–∞—Ç-–º–æ–¥–µ–ª—å—é** –¥–ª—è –æ–±—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.
* **`kafka_service.py`**: –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö NLP-—Å–æ–±—ã—Ç–∏–π –≤ Kafka.

### 2. NLP-—Å–µ—Ä–≤–∏—Å –Ω–∞ Python (`python_interface/nlp_spacy` —Å FastAPI)

–≠—Ç–æ –º–æ–∑–≥, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ **–ø–æ–Ω–∏–º–∞–Ω–∏–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

* **`FastAPI`**: –í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π REST API (`nlp_app.py`). –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—é–¥–∞ HTTP-–∑–∞–ø—Ä–æ—Å—ã —Å —Ç–µ–∫—Å—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **`SpaCy`**: –ú–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (`nlp_service.py`). –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (`nlp_patterns.py`) –¥–ª—è:
    * **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥:** –ù–∞–ø—Ä–∏–º–µ—Ä, "–∫–∞–∫–∞—è –ø–æ–≥–æ–¥–∞", "–ø—Ä–æ–≥–Ω–æ–∑", "–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è".
    * **–ò–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π:** –ì–æ—Ä–æ–¥–∞, –¥–∞—Ç—ã, —É—Å–ª–æ–≤–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã—à–µ, –¥–æ–∂–¥—å, –≤—Ä–µ–º—è).
* **–ò–¥–µ—è:** –ï—Å–ª–∏ SpaCy —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∫–æ–º–∞–Ω–¥—É –∏ —Å—É—â–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ"), —Ç–æ NLP-—Å–µ—Ä–≤–∏—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `{"command": "/weather", "entities": {"city": "–º–æ—Å–∫–≤–∞"}}`). –ï—Å–ª–∏ –∂–µ –∑–∞–ø—Ä–æ—Å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∏ –æ–¥–Ω–æ–º—É –∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, NLP-—Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –ø–æ–º–µ—Ç–∏—Ç—å –µ–≥–æ –∫–∞–∫ "–æ–±—â–∏–π –∑–∞–ø—Ä–æ—Å" (–Ω–∞–ø—Ä–∏–º–µ—Ä, `{"command": "/general_query", "entities": {"original_text": "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?"}}`).

### 3. –ë—ç–∫–µ–Ω–¥ –Ω–∞ C++ (`weather_core`)

–≠—Ç–æ **—Å–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã**, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –≤—Å—é **–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É**, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ –≤–Ω–µ—à–Ω–∏–º–∏ API.

* **`Drogon`**: C++ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –∫–æ—Ç–æ—Ä—ã–π, —Å—É–¥—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –±—ç–∫–µ–Ω–¥–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (`controllers/`) –∏ ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î (`models/`).
* **`KafkaConsumer.h/cc` –∏ `KafkaProducer.h/cc`**: –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Kafka. C++ –±—ç–∫–µ–Ω–¥ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –∫–æ–º–∞–Ω–¥, –ø—Ä–∏—Ö–æ–¥—è—â–∏—Ö –∏–∑ Kafka –æ—Ç Telegram-–±–æ—Ç–∞.
* **`command_logic/`**: –ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ–π –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `WeatherCommand.cc` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥—ã, `ForecastCommand.cc` –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞).
* **`services/`**: –†–∞–∑–ª–∏—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `DataBaseService` (—Ä–∞–±–æ—Ç–∞ —Å PostgreSQL), `WeatherService` (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å OpenWeatherMap API), `NotificationService` (–¥–ª—è –±—É–¥—É—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º).
* **`parsers/`**: –ü–∞—Ä—Å–µ—Ä—ã –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç OpenWeatherMap API –∏–ª–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π Kafka (`TelegramUpdateParser.h/cc`).
* **`models/`**: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ORM-–º–æ–¥–µ–ª–∏ (Drogon's ORM), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —É–¥–æ–±–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ `users`, `messages`, `subscriptions`, `alerts`, `weather_cache` –≤ PostgreSQL.

### 4. Apache Kafka

**–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–∞–±** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.

* **–ò–¥–µ—è:** –í–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É Telegram-–±–æ—Ç–æ–º –∏ C++ –±—ç–∫–µ–Ω–¥–æ–º, Kafka –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ –Ω–∞–¥—ë–∂–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç "—Å–æ–±—ã—Ç–∏—è" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –ø–æ–≥–æ–¥—É –≤ –≥–æ—Ä–æ–¥–µ X") –≤ Kafka, –∞ C++ –±—ç–∫–µ–Ω–¥ –∏—Ö —Å–ª—É—à–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç.
* **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
    * **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –ë–æ—Ç –Ω–µ –∂–¥—ë—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç –±—ç–∫–µ–Ω–¥–∞, –æ–Ω –ø—Ä–æ—Å—Ç–æ "–ø—É–±–ª–∏–∫—É–µ—Ç" —Å–æ–±—ã—Ç–∏–µ –∏ —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    * **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:** –ï—Å–ª–∏ –±—ç–∫–µ–Ω–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ Kafka –∏ –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –±—ç–∫–µ–Ω–¥ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–º.
    * **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ C++ –±—ç–∫–µ–Ω–¥–∞, –∏ –æ–Ω–∏ –±—É–¥—É—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka.

### 5. PostgreSQL

**–ù–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö.**

* **–ò–¥–µ—è:** –•—Ä–∞–Ω–∏—Ç –≤—Å—é –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (`users`), –∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è (`messages`), –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –ø–æ–≥–æ–¥—É (`subscriptions`), –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (`alerts`) –∏ –∫—ç—à –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (`weather_cache`).

### 6. OpenWeatherMap API

**–í–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö.**

* **–ò–¥–µ—è:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ –ø–æ –∑–∞–ø—Ä–æ—Å—É. `WeatherService` –≤ C++ –±—ç–∫–µ–Ω–¥–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —ç—Ç–∏–º API.

---

## üîó –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ (–ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö)

–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–≤–æ–µ–π —Å–∏—Å—Ç–µ–º–µ –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1.  **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -> Telegram-–±–æ—Ç:**
    * –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram.
    * `python_bot/main.py` (—á–µ—Ä–µ–∑ `python-telegram-bot`) –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.
    * –°–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `python_bot/nlp_handler.py`.

2.  **Telegram-–±–æ—Ç (NLP-handler) -> NLP-—Å–µ—Ä–≤–∏—Å (FastAPI):**
    * `nlp_handler.py` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP POST-–∑–∞–ø—Ä–æ—Å —Å —Ç–µ–∫—Å—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ `http://nlp_service:8000/process_text`.
    * `nlp_spacy/nlp_app.py` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å.
    * `nlp_spacy/nlp_service.py` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å –ø–æ–º–æ—â—å—é SpaCy, –∏–∑–≤–ª–µ–∫–∞—è –∫–æ–º–∞–Ω–¥—É –∏ —Å—É—â–Ω–æ—Å—Ç–∏ (–∏–ª–∏ –ø–æ–º–µ—á–∞—è –∫–∞–∫ –æ–±—â–∏–π –∑–∞–ø—Ä–æ—Å).
    * NLP-—Å–µ—Ä–≤–∏—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-–æ—Ç–≤–µ—Ç (`{"command": "/weather", "entities": {...}}` –∏–ª–∏ `{"command": "/general_query", ...}`).

3.  **NLP-—Å–µ—Ä–≤–∏—Å -> Telegram-–±–æ—Ç (NLP-handler):**
    * `nlp_handler.py` –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç NLP-—Å–µ—Ä–≤–∏—Å–∞.

4.  **–í–µ—Ç–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ Telegram-–±–æ—Ç–µ (`nlp_handler.py`):**
    * **–ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ `/general_query`:**
        * `nlp_handler.py` –≤—ã–∑—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π `chat_model_service.py`.
        * `chat_model_service.py` –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–π/–ª–æ–∫–∞–ª—å–Ω–æ–π —á–∞—Ç-–º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Gemini, GPT) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞.
        * –ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç —á–∞—Ç-–º–æ–¥–µ–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ Telegram API (`context.bot.send_message`). **–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ Kafka –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤—É–µ—Ç—Å—è.**
    * **–ï—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/weather`, `/forecast`, `/subscribe`):
        * `nlp_handler.py` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Kafka, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –∫–æ–º–∞–Ω–¥—É, —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.
        * –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Kafka —á–µ—Ä–µ–∑ `python_bot/kafka_service.py` (—Ç–æ–ø–∏–∫ `bot_commands`).

5.  **Kafka -> C++ –±—ç–∫–µ–Ω–¥:**
    * `weather_core/kafka/KafkaConsumer.cc` –≤ C++ –±—ç–∫–µ–Ω–¥–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–ª—É—à–∞–µ—Ç —Ç–æ–ø–∏–∫ `bot_commands` –≤ Kafka.
    * –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è, `KafkaConsumer` –ø–µ—Ä–µ–¥–∞—ë—Ç –µ–≥–æ –¥–∞–ª—å—à–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.
    * `TelegramUpdateParser.h/cc` —Ä–∞–∑–±–∏—Ä–∞–µ—Ç JSON-—Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Kafka –≤ –æ–±—ä–µ–∫—Ç—ã C++.

6.  **C++ –±—ç–∫–µ–Ω–¥: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã:**
    * –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏–∑ `command_logic/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `WeatherCommand.cc`).
    * –≠—Ç–∞ –ª–æ–≥–∏–∫–∞ –º–æ–∂–µ—Ç:
        * –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å **PostgreSQL** —á–µ—Ä–µ–∑ `DataBaseService.cc` –∏ ORM-–º–æ–¥–µ–ª–∏ (`models/`) –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/—á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–¥–ø–∏—Å–æ–∫, —Å–æ–æ–±—â–µ–Ω–∏–π.
        * –í—ã–∑—ã–≤–∞—Ç—å `WeatherService.cc` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç **OpenWeatherMap API**.
        * –ü—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    * –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥–ø–∏—Å–∫–µ) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è.

7.  **C++ –±—ç–∫–µ–Ω–¥ -> Kafka -> Telegram-–±–æ—Ç:**
    * –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥—ã, C++ –±—ç–∫–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç —Å –ø–æ–≥–æ–¥–æ–π) –≤ –¥—Ä—É–≥–æ–π Kafka-—Ç–æ–ø–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bot_responses`) —á–µ—Ä–µ–∑ `weather_core/kafka/KafkaProducer.cc` –∏ `KafkaResponseSender.h/cc`.
    * Telegram-–±–æ—Ç (–≤–µ—Ä–æ—è—Ç–Ω–æ, –¥—Ä—É–≥–æ–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å Kafka –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç —ç—Ç–æ—Ç —Ç–æ–ø–∏–∫) –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–æ –æ—Ç–≤–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
    * –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ Telegram API.

–≠—Ç–∞ —Å–ª–æ–∂–Ω–∞—è, –Ω–æ –º–æ—â–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–≤–æ–µ–π —Å–∏—Å—Ç–µ–º–µ –±—ã—Ç—å –≥–∏–±–∫–æ–π –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π. –¢—ã –º–æ–∂–µ—à—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å NLP, –ª–æ–≥–∏–∫—É C++ –∏–ª–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å Kafka –∏ PostgreSQL, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏.

---